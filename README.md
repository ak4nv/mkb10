### Международный классификатор болезней МКБ10 и МКБ-О

#### Установка

Для быстрой установки проекта используйте утилиту **[uv][1]**, доступную как из официальных репозиториев большинства популярных дистрибутивов, так и через [скрипт установки][2] на сайте разработчика. Демоверсию можно посмотреть [тут][0]

```shell
git clone git@github.com:ak4nv/mkb10.git
cd mkb10
make
make run
```

Приложение будет доступно по адресу http://localhost:5000

#### API для построения дерева

**GET** `/api`

Возвращает список классов. [Пример](/api)

```json
[
  {
    "id": 1,
    "name": "НЕКОТОРЫЕ ИНФЕКЦИОННЫЕ И ПАРАЗИТАРНЫЕ БОЛЕЗНИ (A00-B99)"
  },
  // ...
]
```

**GET** `/api/{id}`

  - `id` Идентификатор класса

Возвращает список блоков класса. [Пример](/api/1)

```json
[
  {
    "id": 2,
    "name": "КИШЕЧНЫЕ ИНФЕКЦИИ (A00-A09)"
  },
  // ...
]
```

**GET** `/api/{id}/group?all`

  - `id` Идентификатор блока
  - `all` Вывести все коды (включая неактуальные). Аргумент необязательный.

Возвращает список групп блока. [Пример](/api/2/group?all)

```json
[
  {
    "actual": true, // Параметр доступен только при указании аргумента 'all'
    "code": "A00",
    "id": "3",
    "has_subgroup": true, // есть ли у группы подргуппа
    "name": "Холера"
  },
  // ...
]
```

**GET** `/api/{code}/subgroup?all`

  - `code` Код группы
  - `all` Вывести все коды (включая неактуальные). Аргумент необязательный.

Возвращает список подргуппы заданной группы. [Пример](/api/A00/subgroup?all)

```json
[
  {
    "actual": true, // Параметр доступен только при указании аргумента 'all'
    "code": "A00.0",
    "id": "4",
    "name": "Холера, вызванная холерным вибрионом 01, биовар cholerae"
  },
  {
    "actual": true, // Параметр доступен только при указании аргумента 'all'
    "code": "A00.1",
    "id": "5",
    "name": "Холера, вызванная холерным вибрионом 01, биовар eltor"
  },
  {
    "actual": true, // Параметр доступен только при указании аргумента 'all'
    "code": "A00.9",
    "id": "6",
    "name": "Холера неуточненная"
  }
]
```

**GET** `/api/icdo/block`

Возвращает список блоков справочника МКБ-О. [Пример](/api/icdo/block)

```json
[
  {
    "id": 1,
    "name": "800 Новообразования, БДУ"
  },
  {
    "id": 15,
    "name": "801—804 Эпителиальные  новообразования, БДУ"
  },
  // ...
]
```

**GET** `/api/icdo/block/{id}`

  - `id` Идентификатор блока

Возвращает список болезней блока. [Пример](/api/icdo/block/106)

```json
[
  {
    "code": "8140/0",
    "id": "107",
    "name": "Аденома БДУ"
  },
  {
    "code": "8140/1",
    "id": "108",
    "name": "Аденома бронхиальных желез БДУ (D38.1)"
  },
  // ...
]
```

#### API для поиска и разрешения имён

**GET** `/api/lookup` Поиск по МКБ-10

**GET** `/api/icdo/lookup` Поиск по МКБ-О

  - `q` Строка поиска (обязательный аргумент). Если аргумент начинается на [a-z], то поиск осуществляется по кодам, иначе по названию
  - `limit` Ограничение на количество выдаваемых кодов. Значение по-умолчанию: 50

Поиск по коду, начинающемуся `I` с лимитом выдачи в `1`.  [Пример](http://localhost:5000/api/lookup?q=i&limit=1)

```json
[
    {
      "code": "I00",
      "name": "Ревматическая лихорадка без упоминания о вовлечении сердца"
    }
]
```

**GET**  `/api/fetch?codes=` Запрос в МКБ-10

**GET**  `/api/icdo/fetch?codes=` Запрос в МКБ-О

  - `codes` Список кодов через запятую

**POST**  `/api/fetch` Запрос в МКБ-10

**POST**  `/api/icdo/fetch` Запрос в МКБ-О

  - `["code1", "code2"]` JSON-список кодов (пример ниже)

Получить название болезней, соответствующие кодам `A00` и `A01`.

> Примеры запросов (cURL). Оба запроса вернут одинаковый ответ.

```bash
curl http://localhost:5000/api/fetch?codes=A00,A01
curl -X POST -d '["A00","A01"]' http://localhost:5000/api/fetch
```

> Пример ответа

```json

[
  {
    "code": "A00",
    "name": "Холера"
  },
  {
    "code": "A01",
    "name": "Тиф и паратиф"
  }
]
```

#### Дополнительно

- `1.2.643.5.1.13.13.11.1005_2.27.csv` Международная статистическая классификация болезней и проблем, связанных со здоровьем (10-й пересмотр)
- `1.2.643.5.1.13.13.11.1486_2.7.csv` Международная классификация болезней – Онкология (3 издание). Морфологические коды
- `init_db` Скрипт для создания базы данных

Источник данных: [Минздрав РФ][3]

[0]: https://mkb.k4nv.me
[1]: https://docs.astral.sh/uv "Python package and project manager"
[2]: https://docs.astral.sh/uv/getting-started/installation/ "Установка uv"
[3]: https://nsi.rosminzdrav.ru "Сайт Росминздрава РФ"
